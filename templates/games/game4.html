<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µ í”¼í•˜ê¸° ê²Œì„</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            user-select: none;
        }
        
        #gameCanvas {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            display: block;
        }
        
        #gameContainer {
            position: relative;
        }
        
        #startScreen, #gameOverScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
        }
        
        #gameOverScreen {
            display: none;
        }
        
        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        button {
            background: linear-gradient(135deg, #ff5f6d, #ffc371);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        #scoreDisplay {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        #highScoreDisplay {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #ffc371;
        }
        
        .instructions {
            margin-top: 20px;
            font-size: 1.1em;
            max-width: 80%;
            line-height: 1.5;
        }
        
        .powerup-indicator {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .powerup-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <div id="startScreen">
            <h1>ê³µ í”¼í•˜ê¸° ê²Œì„</h1>
            <div class="instructions">
                í™”ë©´ ì•„ë¬´ ê³³ì´ë‚˜ í´ë¦­í•˜ì—¬ í”Œë ˆì´ì–´ë¥¼ ì´ë™ì‹œí‚µë‹ˆë‹¤.<br>
                ë–¨ì–´ì§€ëŠ” ê³µì„ í”¼í•˜ë©´ì„œ ìµœëŒ€í•œ ì˜¤ë˜ ìƒì¡´í•˜ì„¸ìš”!<br>
                íŒŒì›Œì—…ì„ íšë“í•˜ë©´ íŠ¹ë³„í•œ ëŠ¥ë ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
            <button id="startButton">ê²Œì„ ì‹œì‘</button>
        </div>
        
        <div id="gameOverScreen">
            <h1>ê²Œì„ ì˜¤ë²„!</h1>
            <div id="finalScore">ì ìˆ˜: 0</div>
            <div id="finalHighScore">ìµœê³  ê¸°ë¡: 0</div>
            <button id="restartButton">ë‹¤ì‹œ ì‹œì‘</button>
        </div>
    </div>

    <script>
        // ê²Œì„ ì„¤ì •
        const config = {
            width: 800,
            height: 600,
            playerSize: 30,
            playerSpeed: 15,
            initialBallCount: 3,
            ballSpawnRate: 60,
            ballSpeedIncrease: 0.1,
            powerupSpawnRate: 0.01,
            powerupDuration: 300,
            scorePerSecond: 10,
            colors: {
                player: '#4CAF50',
                balls: ['#FF5252', '#FFEB3B', '#03A9F4', '#9C27B0'],
                powerups: {
                    shield: '#2196F3',
                    slow: '#FF9800',
                    double: '#4CAF50',
                    clear: '#F44336'
                }
            }
        };

        // ê²Œì„ ìƒíƒœ
        let gameState = {
            canvas: null,
            ctx: null,
            player: null,
            balls: [],
            powerups: [],
            score: 0,
            highScore: localStorage.getItem('highScore') || 0,
            gameTime: 0,
            frameCount: 0,
            isRunning: false,
            activePowerups: {},
            lastMousePos: { x: 0, y: 0 }
        };

        // ê²Œì„ ê°ì²´
        class Player {
            constructor(x, y, size) {
                this.x = x;
                this.y = y;
                this.size = size;
                this.color = config.colors.player;
                this.shield = false;
            }
            
            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                if (this.shield) {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size + 5, 0, Math.PI * 2);
                    ctx.strokeStyle = config.colors.powerups.shield;
                    ctx.lineWidth = 3;
                    ctx.stroke();
                }
            }
            
            moveTo(x, y) {
                // ë¶€ë“œëŸ¬ìš´ ì´ë™ì„ ìœ„í•´ í˜„ì¬ ìœ„ì¹˜ì—ì„œ ëª©í‘œ ìœ„ì¹˜ë¡œ ì ì§„ì ìœ¼ë¡œ ì´ë™
                const dx = x - this.x;
                const dy = y - this.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > config.playerSpeed) {
                    this.x += (dx / distance) * config.playerSpeed;
                    this.y += (dy / distance) * config.playerSpeed;
                } else {
                    this.x = x;
                    this.y = y;
                }
                
                // í™”ë©´ ê²½ê³„ ì²˜ë¦¬
                this.x = Math.max(this.size, Math.min(config.width - this.size, this.x));
                this.y = Math.max(this.size, Math.min(config.height - this.size, this.y));
            }
        }

        class Ball {
            constructor() {
                this.reset();
                this.speed = 2 + Math.random() * 2;
                this.color = config.colors.balls[Math.floor(Math.random() * config.colors.balls.length)];
            }
            
            reset() {
                this.x = Math.random() * config.width;
                this.y = -20;
                this.size = 10 + Math.random() * 20;
            }
            
            update() {
                this.y += this.speed;
                
                if (this.y > config.height + this.size) {
                    this.reset();
                    this.speed += config.ballSpeedIncrease;
                    return true; // í™”ë©´ ì•„ë˜ë¡œ ë–¨ì–´ì§„ ê²½ìš° true ë°˜í™˜
                }
                return false;
            }
            
            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }
        }

        class Powerup {
            constructor(type) {
                this.type = type;
                this.x = Math.random() * config.width;
                this.y = -20;
                this.size = 15;
                this.speed = 3;
                this.color = config.colors.powerups[type];
            }
            
            update() {
                this.y += this.speed;
                return this.y > config.height + this.size;
            }
            
            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // íŒŒì›Œì—… íƒ€ì… í‘œì‹œ
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                let symbol = '';
                switch(this.type) {
                    case 'shield': symbol = 'S'; break;
                    case 'slow': symbol = 'âŒ›'; break;
                    case 'double': symbol = '2X'; break;
                    case 'clear': symbol = 'C'; break;
                }
                
                ctx.fillText(symbol, this.x, this.y);
            }
        }

        // ê²Œì„ ì´ˆê¸°í™”
        function initGame() {
            gameState.canvas = document.getElementById('gameCanvas');
            gameState.ctx = gameState.canvas.getContext('2d');
            
            gameState.canvas.width = config.width;
            gameState.canvas.height = config.height;
            
            gameState.player = new Player(config.width / 2, config.height - 50, config.playerSize);
            gameState.balls = [];
            gameState.powerups = [];
            gameState.score = 0;
            gameState.gameTime = 0;
            gameState.frameCount = 0;
            gameState.activePowerups = {};
            
            // ì´ˆê¸° ê³µ ìƒì„±
            for (let i = 0; i < config.initialBallCount; i++) {
                gameState.balls.push(new Ball());
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            gameState.canvas.addEventListener('click', handleCanvasClick);
            document.getElementById('startButton').addEventListener('click', startGame);
            document.getElementById('restartButton').addEventListener('click', startGame);
        }

        // ê²Œì„ ì‹œì‘
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOverScreen').style.display = 'none';
            
            gameState.isRunning = true;
            gameState.player = new Player(config.width / 2, config.height - 50, config.playerSize);
            gameState.balls = [];
            gameState.powerups = [];
            gameState.score = 0;
            gameState.gameTime = 0;
            gameState.frameCount = 0;
            gameState.activePowerups = {};
            
            for (let i = 0; i < config.initialBallCount; i++) {
                gameState.balls.push(new Ball());
            }
            
            requestAnimationFrame(gameLoop);
        }

        // ê²Œì„ ì˜¤ë²„ ì²˜ë¦¬
        function gameOver() {
            gameState.isRunning = false;
            
            // ìµœê³  ê¸°ë¡ ì—…ë°ì´íŠ¸
            if (gameState.score > gameState.highScore) {
                gameState.highScore = gameState.score;
                localStorage.setItem('highScore', gameState.highScore);
            }
            
            // ê²Œì„ ì˜¤ë²„ í™”ë©´ ì—…ë°ì´íŠ¸
            document.getElementById('finalScore').textContent = `ì ìˆ˜: ${gameState.score}`;
            document.getElementById('finalHighScore').textContent = `ìµœê³  ê¸°ë¡: ${gameState.highScore}`;
            document.getElementById('gameOverScreen').style.display = 'flex';
        }

        // ê²Œì„ ë£¨í”„
        function gameLoop(timestamp) {
            if (!gameState.isRunning) return;
            
            update();
            render();
            
            requestAnimationFrame(gameLoop);
        }

        // ê²Œì„ ìƒíƒœ ì—…ë°ì´íŠ¸
        function update() {
            gameState.frameCount++;
            gameState.gameTime += 1/60; // ëŒ€ëµì ì¸ ì´ˆ ë‹¨ìœ„ ì‹œê°„
            
            // ì ìˆ˜ ì—…ë°ì´íŠ¸ (ì´ˆë‹¹ ì ìˆ˜)
            gameState.score += config.scorePerSecond / 60;
            
            // ê³µ ì—…ë°ì´íŠ¸
            let ballsPassed = 0;
            gameState.balls.forEach(ball => {
                if (ball.update()) {
                    ballsPassed++;
                }
            });
            
            // ì¼ì • í™•ë¥ ë¡œ ìƒˆ ê³µ ì¶”ê°€
            if (gameState.frameCount % config.ballSpawnRate === 0) {
                gameState.balls.push(new Ball());
            }
            
            // íŒŒì›Œì—… ì—…ë°ì´íŠ¸
            gameState.powerups = gameState.powerups.filter(powerup => !powerup.update());
            
            // íŒŒì›Œì—… ìƒì„±
            if (Math.random() < config.powerupSpawnRate) {
                const types = ['shield', 'slow', 'double', 'clear'];
                const type = types[Math.floor(Math.random() * types.length)];
                gameState.powerups.push(new Powerup(type));
            }
            
            // í™œì„± íŒŒì›Œì—… ì—…ë°ì´íŠ¸
            for (const type in gameState.activePowerups) {
                gameState.activePowerups[type]--;
                
                if (gameState.activePowerups[type] <= 0) {
                    delete gameState.activePowerups[type];
                    
                    // íŒŒì›Œì—… íš¨ê³¼ í•´ì œ
                    if (type === 'shield') {
                        gameState.player.shield = false;
                    } else if (type === 'slow') {
                        gameState.balls.forEach(ball => ball.speed *= 2);
                    } else if (type === 'double') {
                        // ì ìˆ˜ ë°°ìœ¨ íš¨ê³¼ëŠ” ìë™ìœ¼ë¡œ í•´ì œë¨
                    }
                }
            }
            
            // ì¶©ëŒ ê²€ì‚¬
            checkCollisions();
        }

        // ì¶©ëŒ ê²€ì‚¬
        function checkCollisions() {
            const player = gameState.player;
            
            // íŒŒì›Œì—… ì¶©ëŒ ê²€ì‚¬
            for (let i = gameState.powerups.length - 1; i >= 0; i--) {
                const powerup = gameState.powerups[i];
                const dx = player.x - powerup.x;
                const dy = player.y - powerup.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < player.size + powerup.size) {
                    // íŒŒì›Œì—… íšë“
                    activatePowerup(powerup.type);
                    gameState.powerups.splice(i, 1);
                }
            }
            
            // ê³µ ì¶©ëŒ ê²€ì‚¬
            if (gameState.activePowerups.shield) {
                return; // ì‰´ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ì¶©ëŒ ë¬´ì‹œ
            }
            
            for (const ball of gameState.balls) {
                const dx = player.x - ball.x;
                const dy = player.y - ball.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < player.size + ball.size) {
                    gameOver();
                    return;
                }
            }
        }

        // íŒŒì›Œì—… í™œì„±í™”
        function activatePowerup(type) {
            // ê¸°ì¡´ ë™ì¼ íƒ€ì… íŒŒì›Œì—…ì´ ìˆìœ¼ë©´ ì§€ì†ì‹œê°„ ì—°ì¥
            if (gameState.activePowerups[type]) {
                gameState.activePowerups[type] = config.powerupDuration;
            } else {
                gameState.activePowerups[type] = config.powerupDuration;
            }
            
            // íŒŒì›Œì—… íš¨ê³¼ ì ìš©
            switch(type) {
                case 'shield':
                    gameState.player.shield = true;
                    break;
                case 'slow':
                    gameState.balls.forEach(ball => ball.speed *= 0.5);
                    break;
                case 'double':
                    // ì ìˆ˜ ë°°ìœ¨ íš¨ê³¼ëŠ” ë Œë”ë§ ì‹œ ì²˜ë¦¬
                    break;
                case 'clear':
                    // í™”ë©´ì˜ ëª¨ë“  ê³µ ì œê±°
                    gameState.balls = [];
                    break;
            }
        }

        // ë Œë”ë§
        function render() {
            const ctx = gameState.ctx;
            
            // ë°°ê²½ ê·¸ë¦¬ê¸°
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(0, 0, config.width, config.height);
            
            // ê³µ ê·¸ë¦¬ê¸°
            gameState.balls.forEach(ball => ball.draw(ctx));
            
            // íŒŒì›Œì—… ê·¸ë¦¬ê¸°
            gameState.powerups.forEach(powerup => powerup.draw(ctx));
            
            // í”Œë ˆì´ì–´ ê·¸ë¦¬ê¸°
            gameState.player.draw(ctx);
            
            // UI ê·¸ë¦¬ê¸°
            ctx.fillStyle = 'white';
            ctx.font = '20px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`ì ìˆ˜: ${Math.floor(gameState.score)}`, 20, 30);
            ctx.fillText(`ìµœê³  ê¸°ë¡: ${Math.floor(gameState.highScore)}`, 20, 60);
            
            // íŒŒì›Œì—… ì§€ì†ì‹œê°„ í‘œì‹œ
            const powerupX = config.width - 20;
            let powerupY = 30;
            ctx.textAlign = 'right';
            
            for (const type in gameState.activePowerups) {
                let text = '';
                switch(type) {
                    case 'shield': text = 'ğŸ›¡ï¸'; break;
                    case 'slow': text = 'âŒ›'; break;
                    case 'double': text = '2X'; break;
                    case 'clear': text = 'ğŸ’£'; break;
                }
                
                const timeLeft = Math.ceil(gameState.activePowerups[type] / 60);
                ctx.fillText(`${text} ${timeLeft}s`, powerupX, powerupY);
                powerupY += 30;
            }
            
            // ë”ë¸” ì ìˆ˜ ë°°ìœ¨ í‘œì‹œ
            if (gameState.activePowerups.double) {
                ctx.fillStyle = config.colors.powerups.double;
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('2X ì ìˆ˜ ë°°ìœ¨!', config.width / 2, 40);
            }
        }

        // ìº”ë²„ìŠ¤ í´ë¦­ ì²˜ë¦¬
        function handleCanvasClick(e) {
            if (!gameState.isRunning) return;
            
            const rect = gameState.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            gameState.lastMousePos = { x, y };
        }

        // ì£¼ê¸°ì ìœ¼ë¡œ í”Œë ˆì´ì–´ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (ë¶€ë“œëŸ¬ìš´ ì´ë™ì„ ìœ„í•´)
        setInterval(() => {
            if (gameState.isRunning && gameState.player) {
                gameState.player.moveTo(gameState.lastMousePos.x, gameState.lastMousePos.y);
            }
        }, 1000/60);

        // ê²Œì„ ì´ˆê¸°í™” ì‹¤í–‰
        window.onload = initGame;
    </script>
</body>
</html>